# æ€è€ƒè¿‡ç¨‹æŒ‰é’®åŠŸèƒ½

## è®¾è®¡å˜æ›´

### ä¹‹å‰çš„è®¾è®¡
æ€è€ƒè¿‡ç¨‹åœ¨æµå¼å“åº”æ—¶å®æ—¶æ˜¾ç¤ºåœ¨ç‹¬ç«‹çš„ç¥ç€è‰²å¡ç‰‡ä¸­ã€‚

### æ–°çš„è®¾è®¡
æ€è€ƒè¿‡ç¨‹ä¿å­˜åœ¨æ¶ˆæ¯ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªå¯å±•å¼€çš„"æ€è€ƒè¿‡ç¨‹"æŒ‰é’®æ¥æŸ¥çœ‹ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

### 1. æŒ‰é’®æ˜¾ç¤º
- åªæœ‰å½“æ¶ˆæ¯åŒ…å« `reasoning` å†…å®¹æ—¶æ‰æ˜¾ç¤ºæŒ‰é’®
- æŒ‰é’®æ˜¾ç¤ºåœ¨æ¶ˆæ¯å†…å®¹ä¸‹æ–¹
- ä½¿ç”¨ç¥ç€è‰²ä¸»é¢˜ï¼Œä¸æ€è€ƒè¿‡ç¨‹çš„é¢œè‰²ä¸€è‡´

### 2. å±•å¼€/æ”¶èµ·
- ç‚¹å‡»æŒ‰é’®å¯ä»¥å±•å¼€æˆ–æ”¶èµ·æ€è€ƒè¿‡ç¨‹
- ç®­å¤´å›¾æ ‡ä¼šæ—‹è½¬ 90 åº¦è¡¨ç¤ºçŠ¶æ€
- å±•å¼€çš„å†…å®¹æ˜¾ç¤ºåœ¨ç¥ç€è‰²æ¸å˜èƒŒæ™¯ä¸­

### 3. çŠ¶æ€ç®¡ç†
- ä½¿ç”¨ `Set` æ¥è·Ÿè¸ªå“ªäº›æ¶ˆæ¯çš„æ€è€ƒè¿‡ç¨‹æ˜¯å±•å¼€çš„
- æ¯ä¸ªæ¶ˆæ¯ç‹¬ç«‹æ§åˆ¶å±•å¼€/æ”¶èµ·çŠ¶æ€

## UI æ•ˆæœ

### æ”¶èµ·çŠ¶æ€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ ¹æ®æ‚¨çš„é—®é¢˜ï¼Œæˆ‘çš„ç†è§£æ˜¯...         â”‚
â”‚                                     â”‚
â”‚ â–¶ ğŸ’­ æ€è€ƒè¿‡ç¨‹                       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ğŸ“¦ o1-preview | ğŸ”¢ 150 tokens       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å±•å¼€çŠ¶æ€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ ¹æ®æ‚¨çš„é—®é¢˜ï¼Œæˆ‘çš„ç†è§£æ˜¯...         â”‚
â”‚                                     â”‚
â”‚ â–¼ ğŸ’­ æ€è€ƒè¿‡ç¨‹                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ­£åœ¨åˆ†ææ‚¨çš„é—®é¢˜...              â”‚ â”‚
â”‚ â”‚ æ£€ç´¢ç›¸å…³çŸ¥è¯†åº“...                â”‚ â”‚
â”‚ â”‚ æ•´ç†å›ç­”æ€è·¯...                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ğŸ“¦ o1-preview | ğŸ”¢ 150 tokens       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å®ç°ç»†èŠ‚

### æ•°æ®ç»“æ„

```typescript
export interface ChatMessage {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  reasoning?: string;  // æ–°å¢ï¼šä¿å­˜æ€è€ƒè¿‡ç¨‹
  timestamp: Date;
  metadata?: any;
}
```

### çŠ¶æ€ç®¡ç†

```typescript
const [expandedReasonings, setExpandedReasonings] = useState<Set<string>>(new Set());

const toggleReasoning = (messageId: string) => {
  setExpandedReasonings((prev) => {
    const next = new Set(prev);
    if (next.has(messageId)) {
      next.delete(messageId);
    } else {
      next.add(messageId);
    }
    return next;
  });
};
```

### æ¸²æŸ“é€»è¾‘

```tsx
{message.reasoning && message.role === 'assistant' && (
  <div className="mt-3">
    <button
      onClick={() => toggleReasoning(message.id)}
      className="flex items-center space-x-2 text-sm text-amber-700 hover:text-amber-800 font-medium transition-colors"
    >
      <svg 
        className={`w-4 h-4 transition-transform ${expandedReasonings.has(message.id) ? 'rotate-90' : ''}`}
        fill="none" 
        stroke="currentColor" 
        viewBox="0 0 24 24"
      >
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
      </svg>
      <span>ğŸ’­ æ€è€ƒè¿‡ç¨‹</span>
    </button>
    
    {expandedReasonings.has(message.id) && (
      <div className="mt-2 p-3 bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-lg">
        <p className="text-sm text-amber-900 whitespace-pre-wrap leading-relaxed">
          {message.reasoning}
        </p>
      </div>
    )}
  </div>
)}
```

## æµå¼å“åº”å¤„ç†

### 1. æ”¶é›†æ€è€ƒè¿‡ç¨‹
åœ¨æµå¼å“åº”æœŸé—´ï¼Œæ€è€ƒè¿‡ç¨‹ä»ç„¶å®æ—¶æ˜¾ç¤ºåœ¨ç‹¬ç«‹å¡ç‰‡ä¸­ï¼š

```typescript
if (data.reasoning_content) {
  accumulatedReasoning += data.reasoning_content;
  setCurrentReasoning(accumulatedReasoning);
}
```

### 2. ä¿å­˜åˆ°æ¶ˆæ¯
å½“æµå¼å“åº”å®Œæˆæ—¶ï¼Œå°†ç´¯ç§¯çš„æ€è€ƒè¿‡ç¨‹ä¿å­˜åˆ°æ¶ˆæ¯ä¸­ï¼š

```typescript
const assistantMessage: ChatMessage = {
  id: data.reply_id || crypto.randomUUID(),
  role: 'assistant',
  content: accumulatedContent,
  reasoning: accumulatedReasoning || undefined,  // ä¿å­˜æ€è€ƒè¿‡ç¨‹
  timestamp: new Date(),
  metadata: data.metadata,
};
```

### 3. æ¸…ç†ä¸´æ—¶çŠ¶æ€
```typescript
setIsStreaming(false);
setCurrentResponse('');
setCurrentReasoning('');  // æ¸…ç†ä¸´æ—¶çš„æ€è€ƒè¿‡ç¨‹
```

## ç”¨æˆ·ä½“éªŒ

### æµå¼å“åº”æ—¶
```
ğŸ¤– [æ€è€ƒè¿‡ç¨‹ - å®æ—¶æ›´æ–°]
   ğŸ’­ æ­£åœ¨åˆ†æé—®é¢˜...
   æ£€ç´¢çŸ¥è¯†åº“...â–ˆ

ğŸ¤– [å›å¤å†…å®¹ - å®æ—¶æ›´æ–°]
   æ ¹æ®åˆ†æ...â–ˆ
```

### å®Œæˆå
```
ğŸ¤– [å›å¤å†…å®¹]
   æ ¹æ®åˆ†æç»“æœï¼Œæˆ‘å»ºè®®...
   
   â–¶ ğŸ’­ æ€è€ƒè¿‡ç¨‹  â† ç‚¹å‡»å±•å¼€
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ“¦ o1-preview | ğŸ”¢ 150 tokens
```

### å±•å¼€å
```
ğŸ¤– [å›å¤å†…å®¹]
   æ ¹æ®åˆ†æç»“æœï¼Œæˆ‘å»ºè®®...
   
   â–¼ ğŸ’­ æ€è€ƒè¿‡ç¨‹  â† ç‚¹å‡»æ”¶èµ·
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ æ­£åœ¨åˆ†æé—®é¢˜...          â”‚
   â”‚ æ£€ç´¢çŸ¥è¯†åº“...            â”‚
   â”‚ æ•´ç†å›ç­”æ€è·¯...          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ“¦ o1-preview | ğŸ”¢ 150 tokens
```

## ä¼˜åŠ¿

### 1. æ›´æ¸…æ™°çš„ç•Œé¢
- é»˜è®¤ä¸æ˜¾ç¤ºæ€è€ƒè¿‡ç¨‹ï¼Œç•Œé¢æ›´ç®€æ´
- ç”¨æˆ·å¯ä»¥é€‰æ‹©æ€§æŸ¥çœ‹æ„Ÿå…´è¶£çš„æ€è€ƒè¿‡ç¨‹

### 2. æ›´å¥½çš„å¯è¯»æ€§
- æ€è€ƒè¿‡ç¨‹ä¸ä¼šå¹²æ‰°ä¸»è¦å†…å®¹çš„é˜…è¯»
- å±•å¼€åçš„å†…å®¹æœ‰æ˜ç¡®çš„è§†è§‰è¾¹ç•Œ

### 3. æ›´çµæ´»çš„äº¤äº’
- ç”¨æˆ·å¯ä»¥éšæ—¶å±•å¼€/æ”¶èµ·
- å¯ä»¥å¯¹æ¯”å¤šä¸ªæ¶ˆæ¯çš„æ€è€ƒè¿‡ç¨‹

### 4. æ›´å¥½çš„æ€§èƒ½
- ä¸éœ€è¦ä¸ºæ¯ä¸ªæ¶ˆæ¯æ¸²æŸ“å¤§é‡çš„æ€è€ƒå†…å®¹
- åªåœ¨éœ€è¦æ—¶æ‰æ¸²æŸ“å±•å¼€çš„å†…å®¹

## æ ·å¼ç»†èŠ‚

### æŒ‰é’®æ ·å¼
```css
- æ–‡å­—é¢œè‰²: text-amber-700
- æ‚¬åœé¢œè‰²: text-amber-800
- å­—ä½“å¤§å°: text-sm
- å­—ä½“ç²—ç»†: font-medium
- è¿‡æ¸¡æ•ˆæœ: transition-colors
```

### ç®­å¤´åŠ¨ç”»
```css
- é»˜è®¤: å‘å³ (â†’)
- å±•å¼€: æ—‹è½¬ 90 åº¦å‘ä¸‹ (â†“)
- è¿‡æ¸¡: transition-transform
```

### å†…å®¹åŒºåŸŸ
```css
- èƒŒæ™¯: bg-gradient-to-r from-amber-50 to-orange-50
- è¾¹æ¡†: border border-amber-200
- åœ†è§’: rounded-lg
- å†…è¾¹è·: p-3
- æ–‡å­—é¢œè‰²: text-amber-900
- å­—ä½“å¤§å°: text-sm
```

## å…¼å®¹æ€§

- âœ… å‘åå…¼å®¹ï¼šæ²¡æœ‰ reasoning çš„æ¶ˆæ¯ä¸æ˜¾ç¤ºæŒ‰é’®
- âœ… å“åº”å¼è®¾è®¡ï¼šåœ¨ç§»åŠ¨ç«¯ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ
- âœ… é”®ç›˜è®¿é—®ï¼šæŒ‰é’®å¯ä»¥é€šè¿‡é”®ç›˜æ“ä½œ
- âœ… å±å¹•é˜…è¯»å™¨ï¼šä½¿ç”¨è¯­ä¹‰åŒ–çš„ HTML

## æµ‹è¯•

### 1. åŠŸèƒ½æµ‹è¯•
- [ ] æœ‰ reasoning çš„æ¶ˆæ¯æ˜¾ç¤ºæŒ‰é’®
- [ ] æ²¡æœ‰ reasoning çš„æ¶ˆæ¯ä¸æ˜¾ç¤ºæŒ‰é’®
- [ ] ç‚¹å‡»æŒ‰é’®å¯ä»¥å±•å¼€/æ”¶èµ·
- [ ] ç®­å¤´å›¾æ ‡æ­£ç¡®æ—‹è½¬
- [ ] å¤šä¸ªæ¶ˆæ¯å¯ä»¥ç‹¬ç«‹å±•å¼€/æ”¶èµ·

### 2. æ ·å¼æµ‹è¯•
- [ ] æŒ‰é’®é¢œè‰²æ­£ç¡®
- [ ] æ‚¬åœæ•ˆæœæ­£å¸¸
- [ ] å±•å¼€å†…å®¹æ ·å¼æ­£ç¡®
- [ ] åŠ¨ç”»æµç•…

### 3. æµå¼å“åº”æµ‹è¯•
- [ ] æµå¼å“åº”æ—¶æ€è€ƒè¿‡ç¨‹å®æ—¶æ˜¾ç¤º
- [ ] å®Œæˆåæ€è€ƒè¿‡ç¨‹ä¿å­˜åˆ°æ¶ˆæ¯
- [ ] ä¸´æ—¶çŠ¶æ€æ­£ç¡®æ¸…ç†

## ç¤ºä¾‹ä»£ç 

### å®Œæ•´çš„æ¶ˆæ¯æ¸²æŸ“
```tsx
<div className="flex items-start space-x-3">
  {/* å¤´åƒ */}
  <div className="flex-shrink-0 w-8 h-8 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white shadow-md">
    ğŸ¤–
  </div>
  
  {/* æ¶ˆæ¯å†…å®¹ */}
  <div className="flex-1">
    <div className="bg-white rounded-lg shadow-sm p-4 border border-gray-100">
      {/* ä¸»è¦å†…å®¹ */}
      <p className="whitespace-pre-wrap leading-relaxed">
        {message.content}
      </p>
      
      {/* æ€è€ƒè¿‡ç¨‹æŒ‰é’® */}
      {message.reasoning && (
        <div className="mt-3">
          <button onClick={() => toggleReasoning(message.id)}>
            <svg className={expandedReasonings.has(message.id) ? 'rotate-90' : ''}>
              {/* ç®­å¤´å›¾æ ‡ */}
            </svg>
            <span>ğŸ’­ æ€è€ƒè¿‡ç¨‹</span>
          </button>
          
          {expandedReasonings.has(message.id) && (
            <div className="mt-2 p-3 bg-gradient-to-r from-amber-50 to-orange-50">
              <p>{message.reasoning}</p>
            </div>
          )}
        </div>
      )}
      
      {/* å…ƒæ•°æ® */}
      {message.metadata && (
        <div className="mt-3 pt-3 border-t">
          {/* æ¨¡å‹ã€tokens ç­‰ */}
        </div>
      )}
    </div>
  </div>
</div>
```

## æ€»ç»“

æ–°çš„è®¾è®¡é€šè¿‡å¯å±•å¼€çš„æŒ‰é’®æ¥æ˜¾ç¤ºæ€è€ƒè¿‡ç¨‹ï¼Œæä¾›äº†ï¼š
- âœ… æ›´æ¸…æ™°çš„ç•Œé¢
- âœ… æ›´å¥½çš„å¯è¯»æ€§
- âœ… æ›´çµæ´»çš„äº¤äº’
- âœ… æ›´å¥½çš„æ€§èƒ½

ç”¨æˆ·å¯ä»¥åœ¨éœ€è¦æ—¶æŸ¥çœ‹æ€è€ƒè¿‡ç¨‹ï¼Œè€Œä¸ä¼šè¢«å¤§é‡çš„æ€è€ƒå†…å®¹å¹²æ‰°ä¸»è¦çš„å¯¹è¯æµç¨‹ã€‚
